<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!-- saved from url=(0025)http://www.helpsmith.com/ -->
<head>
<title>Beam plugin (INP UI)</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
<meta name="generator" content="HelpSmith 6.4 (Build 17.127)" />
<style type="text/css" media="screen">
html {
  height: 100%;
}
body {
  background-color: LemonChiffon;
  margin: 0.06in 0.06in 0.06in 0.06in;
}
</style>
<link type="text/css" href="../css/topics/style.css" rel="stylesheet" />
<script type="text/javascript" src="../js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="../js/settings.js?d2c0b536"></script>
<script type="text/javascript" src="../js/core.js?e3fa3091"></script>
<script type="text/javascript" src="../js/topic.js?e3fa3091"></script>
<script type="text/javascript">
	var topicContext = 680;
</script>
</head>
<body>
<div align="left">
  <table class="tbl2">
    <tr class="row0">
      <td class="cell0">
        <p class="ps5"><span class="ts16">//## </span><span class="ts17">Description:</span><span class="ts18">&nbsp;</span><span class="ts24">Beam plug-in (with .inp file user interface)</span><br /><span class="ts16">//## </span><span class="ts17">Credits:</span><span class="ts18">&nbsp;</span><span class="ts24">Tekla Corporation (Tekla OpenAPI Startup Package)</span></p>
      </td>
    </tr>
    <tr class="row0">
      <td class="cell1">
        <p class="ps6"><br /><span class="ts19">//Hint: Add the following Dlls to references:</span><br /><span class="ts19">//&quot;Tekla.Structures.dll&quot;</span><br /><span class="ts19">//&quot;Tekla.Structures.Model.dll&quot;</span><br /><span class="ts19">//&quot;Tekla.Structures.Plugins.dll&quot;</span><br /><span class="ts19">//Location: ~\[version]\nt\bin\plugins</span><br /><br /><span class="ts20">using</span><span class="ts21">&nbsp;System;</span><br /><span class="ts20">using</span><span class="ts21">&nbsp;System.Collections.Generic;</span><br /><span class="ts20">using</span><span class="ts21">&nbsp;Tekla.Structures.Plugins;</span><br /><span class="ts20">using</span><span class="ts21">&nbsp;Tekla.Structures.Geometry3d;</span><br /><span class="ts20">using</span><span class="ts21">&nbsp;Tekla.Structures.Model.UI;</span><br /><span class="ts20">using</span><span class="ts21">&nbsp;TSM = Tekla.Structures.Model;</span><br /><br /><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">class</span><span class="ts21">&nbsp;</span><span class="ts55">StructuresData</span><br /><span class="ts21">{</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; [StructuresField(</span><span class="ts22">&quot;P1&quot;</span><span class="ts21">)]</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">double</span><span class="ts21">&nbsp;Parameter1;</span><br /><span class="ts21">}</span><br /><br /><span class="ts21">[Plugin(</span><span class="ts22">&quot;BeamPlugin&quot;</span><span class="ts21">)] </span><span class="ts19">// Mandatory field which defines that this is the plug-in and stores the name of the plug-in to the system.</span><br /><span class="ts21">[PluginUserInterface(BeamPlugin.UserInterfaceDefinitions.Plugin1)] </span><span class="ts19">// Mandatory field which defines the user interface the plug-in uses. A Windows Forms class or a .inp file.</span><br /><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">class</span><span class="ts21">&nbsp;</span><span class="ts55">BeamPlugin</span><span class="ts21">&nbsp;: PluginBase</span><br /><span class="ts21">{</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">private</span><span class="ts21">&nbsp;</span><span class="ts20">readonly</span><span class="ts21">&nbsp;StructuresData data;</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts19">// The constructor argument defines the database class StructuresData and sets the data to be used in the plug-in.</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts55">BeamPlugin</span><span class="ts21">(StructuresData data)</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TSM.Model M = </span><span class="ts20">new</span><span class="ts21">&nbsp;TSM.Model();</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">this</span><span class="ts21">.data = data;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; }</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts19">//Defines the inputs to be passed to the plug-in.</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">override</span><span class="ts21">&nbsp;List&lt;InputDefinition&gt; DefineInput()</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Picker BeamPicker = </span><span class="ts20">new</span><span class="ts21">&nbsp;Picker();</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;InputDefinition&gt; PointList = </span><span class="ts20">new</span><span class="ts21">&nbsp;List&lt;InputDefinition&gt;();</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point Point1 = BeamPicker.PickPoint();</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point Point2 = BeamPicker.PickPoint();</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputDefinition Input1 = </span><span class="ts20">new</span><span class="ts21">&nbsp;InputDefinition(Point1);</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputDefinition Input2 = </span><span class="ts20">new</span><span class="ts21">&nbsp;InputDefinition(Point2);</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PointList.Add(Input1);</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PointList.Add(Input2);</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">return</span><span class="ts21">&nbsp;PointList;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; }</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts19">//Main method of the plug-in.</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">override</span><span class="ts21">&nbsp;</span><span class="ts20">bool</span><span class="ts21">&nbsp;Run(List&lt;InputDefinition&gt; Input)</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">try</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point Point1 = (Point)(Input[0]).GetInput();</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point Point2 = (Point)(Input[1]).GetInput();</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point LengthVector = </span><span class="ts20">new</span><span class="ts21">&nbsp;Point(Point2.X - Point1.X, Point2.Y - Point1.Y, Point2.Z - Point1.Z);</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">if</span><span class="ts21">&nbsp;(data.Parameter1 &gt; 0)</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point2.X = data.Parameter1 * LengthVector.X + Point1.X;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point2.Y = data.Parameter1 * LengthVector.Y + Point1.Y;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point2.Z = data.Parameter1 * LengthVector.Z + Point1.Z;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CreateBeam(Point1, Point2);</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">catch</span><span class="ts21">&nbsp;(Exception)</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">return</span><span class="ts21">&nbsp;</span><span class="ts20">true</span><span class="ts21">;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; }</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">static</span><span class="ts21">&nbsp;</span><span class="ts20">void</span><span class="ts21">&nbsp;CreateBeam(Point Point1, Point Point2)</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TSM.Beam MyBeam = </span><span class="ts20">new</span><span class="ts21">&nbsp;TSM.Beam(Point1, Point2);</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBeam.Profile.ProfileString = </span><span class="ts22">&quot;HEA400&quot;</span><span class="ts21">;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBeam.Finish = </span><span class="ts22">&quot;PAINT&quot;</span><span class="ts21">;</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBeam.Insert();</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; }</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts19">//.inp file user interface definition:</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; </span><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">class</span><span class="ts21">&nbsp;</span><span class="ts55">UserInterfaceDefinitions</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp; {</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts20">public</span><span class="ts21">&nbsp;</span><span class="ts20">const</span><span class="ts21">&nbsp;</span><span class="ts20">string</span><span class="ts21">&nbsp;Plugin1 = </span><span class="ts59">@&quot;&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts59">@&quot;page(&quot;&quot;TeklaStructures&quot;&quot;,&quot;&quot;&quot;&quot;)&quot;</span><span class="ts21">&nbsp;+ </span><span class="ts22">&quot;\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;{\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;&nbsp;&nbsp;&nbsp; plugin(1, BeamPlugin)\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;&nbsp;&nbsp;&nbsp; {\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts59">@&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tab_page(&quot;&quot;Beam test&quot;&quot;, &quot;&quot;Parameters&quot;&quot;, 1)&quot;</span><span class="ts21">&nbsp;+ </span><span class="ts22">&quot;\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts59">@&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parameter(&quot;&quot;Length factor&quot;&quot;, &quot;&quot;P1&quot;&quot;, distance, number, 1)&quot;</span><span class="ts21">&nbsp;+ </span><span class="ts22">&quot;\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;&nbsp;&nbsp;&nbsp; }\n&quot;</span><span class="ts21">&nbsp;+</span><br /><span class="ts21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="ts22">&quot;}\n&quot;</span><span class="ts21">;</span><br /><br /><span class="ts21">&nbsp;&nbsp;&nbsp; }</span><br /><span class="ts21">}</span></p>
      </td>
    </tr>
  </table>
</div>
<p class="ps0"><span class="ts10">&nbsp;</span></p>
<div>
  <div class="hline0"></div>
</div>
<p class="ps0"><span class="ts23">Usage:</span></p>
<p class="ps2"><span class="ts15">This Tekla Open API example plug-in creates a beam defined by user input.</span></p>
<p class="ps2"><span class="ts15">User can select the length factor for the beam. The plug-in asks the user to pick two points. </span></p>
<p class="ps2"><span class="ts15">Based on those points, it calculates new insertion points using a double parameter from the dialog and creates a beam. </span></p>
</body>
</html>